<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>PebbleTools - Volume</title>
<style>
  body {
    background-color: #121212;
    color: #eee;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    padding: 20px;
    margin: 0;
  }
  h2 { margin-bottom: 16px; }
  .container {
    display: flex;
    gap: 20px;
  }
  .column {
    flex: 1;
    border: 1px solid #444;
    border-radius: 8px;
    padding: 15px 20px;
    background-color: #1e1e1e;
    min-width: 230px;
    max-height: 80vh;
    overflow-y: auto;
  }
  .unit-row {
    display: flex;
    align-items: center;
    margin-bottom: 10px;
  }
  .unit-row label {
    width: 130px;
  }
  .unit-row input {
    width: 130px;
    padding: 6px 10px;
    font-size: 1rem;
    border: 1.5px solid #555;
    border-radius: 6px;
    background-color: #222;
    color: #eee;
  }
  .unit-row input:focus {
    outline: none;
    border-color: #3a9bf0;
    box-shadow: 0 0 6px #3a9bf0;
    background-color: #2a2a2a;
  }
</style>
</head>
<body>

<h2>Volume Measurement Converter</h2>
<div class="container">
  <div class="column" id="metric-column"><h3>Metric</h3></div>
  <div class="column" id="imperial-column"><h3>Imperial</h3></div>
  <div class="column" id="misc-column"><h3>Miscellaneous</h3></div>
</div>

<script>
const volumeUnits = [
  // Metric
  { name: "cubic millimeter", toCubicMeter: 1e-9, group: "metric" },
  { name: "cubic centimeter", toCubicMeter: 1e-6, group: "metric" },
  { name: "milliliter", toCubicMeter: 1e-6, group: "metric" },
  { name: "liter", toCubicMeter: 0.001, group: "metric" },
  { name: "cubic meter", toCubicMeter: 1, group: "metric" },
  { name: "cubic kilometer", toCubicMeter: 1e9, group: "metric" },

  // Imperial
  { name: "cubic inch", toCubicMeter: 1.6387e-5, group: "imperial" },
  { name: "cubic foot", toCubicMeter: 0.0283168, group: "imperial" },
  { name: "cubic yard", toCubicMeter: 0.764555, group: "imperial" },
  { name: "gallon (US)", toCubicMeter: 0.00378541, group: "imperial" },
  { name: "quart (US)", toCubicMeter: 0.000946353, group: "imperial" },
  { name: "pint (US)", toCubicMeter: 0.000473176, group: "imperial" },
  { name: "cup (US)", toCubicMeter: 0.000236588, group: "imperial" },
  { name: "tablespoon (US)", toCubicMeter: 1.4787e-5, group: "imperial" },
  { name: "teaspoon (US)", toCubicMeter: 4.9289e-6, group: "imperial" },
  { name: "gallon (UK)", toCubicMeter: 0.00454609, group: "imperial" },
  { name: "pint (UK)", toCubicMeter: 0.000568261, group: "imperial" },

  // Misc
  { name: "barrel (oil)", toCubicMeter: 0.158987, group: "misc" },
];

const containers = {
  metric: document.getElementById("metric-column"),
  imperial: document.getElementById("imperial-column"),
  misc: document.getElementById("misc-column"),
};

volumeUnits.forEach((unit, i) => {
  const container = containers[unit.group];
  const row = document.createElement("div");
  row.className = "unit-row";

  const label = document.createElement("label");
  label.htmlFor = "input" + i;
  label.textContent = unit.name;

  const input = document.createElement("input");
  input.type = "number";
  input.step = "any";
  input.min = "0";
  input.id = "input" + i;
  input.dataset.index = i;

  row.appendChild(label);
  row.appendChild(input);
  container.appendChild(row);
});

let isUpdating = false;

function convertFrom(index, value) {
  if(isUpdating) return;
  isUpdating = true;
  const baseCubicMeters = value * volumeUnits[index].toCubicMeter;
  volumeUnits.forEach((unit, i) => {
    if(i === index) return;
    const converted = baseCubicMeters / unit.toCubicMeter;
    const input = document.getElementById("input" + i);
    input.value = (converted || "").toFixed(6);
  });
  isUpdating = false;
}

volumeUnits.forEach((_, i) => {
  const input = document.getElementById("input" + i);
  input.addEventListener("input", e => {
    const val = parseFloat(e.target.value);
    if(!isNaN(val)) convertFrom(i, val);
    else {
      if(!isUpdating) {
        isUpdating = true;
        volumeUnits.forEach((_, idx) => {
          if(idx !== i) document.getElementById("input" + idx).value = "";
        });
        isUpdating = false;
      }
    }
  });
});
</script>

</body>
</html>
